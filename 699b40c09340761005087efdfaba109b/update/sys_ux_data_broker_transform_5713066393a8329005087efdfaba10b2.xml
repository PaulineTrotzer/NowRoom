<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ux_data_broker_transform">
    <sys_ux_data_broker_transform action="INSERT_OR_UPDATE">
        <acl_failure_result/>
        <api_name>x_1782765_nowroom.events_from_lmr</api_name>
        <batch_exclude>false</batch_exclude>
        <description/>
        <mutates_server_data>false</mutates_server_data>
        <name>events_from_lmr</name>
        <output_schema/>
        <private>false</private>
        <props/>
        <required_translations>[ ]</required_translations>
        <schema_version>1.0.0</schema_version>
        <script><![CDATA[/**
 * @param {any} input   // erwartet: input.rows = Array der LMR-Datensätze
 * @returns {any}
 */
function transform(input) {
	Console.log('script was triggerd');
  var rows = (input && input.rows) || [];
  var events = [];

  for (var i = 0; i < rows.length; i++) {
    var r = rows[i];

    // Werte je nach Struktur (flach vs. value/display_value)
    var sysId  = r.sys_id && (r.sys_id.value || r.sys_id) || '';
    var num    = r.number && (r.number.value || r.number) || '';
    var roomLb = r.room && (r.room.display_value || r.room.displayValue || '') || '';

    var start  = r.planned_start && (r.planned_start.value || r.planned_start) || '';
    var end    = r.planned_end   && (r.planned_end.value   || r.planned_end)   || '';

    // in ISO bringen, falls blank vorhanden: "YYYY-MM-DD HH:mm:ss" -> "YYYY-MM-DDTHH:mm:ss"
    if (start && start.indexOf(' ') > -1) start = start.replace(' ', 'T');
    if (end   && end.indexOf(' ')   > -1) end   = end.replace(' ', 'T');

    events.push({
      id:    sysId || num,
      title: num + (roomLb ? (' — ' + roomLb) : ''),
      start: start,
      end:   end
    });
  }

  return { events: events };
}
]]></script>
        <sys_class_name>sys_ux_data_broker_transform</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-10-18 20:05:18</sys_created_on>
        <sys_id>5713066393a8329005087efdfaba10b2</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>events_from_lmr</sys_name>
        <sys_package display_value="NowRoom" source="x_1782765_nowroom">699b40c09340761005087efdfaba109b</sys_package>
        <sys_policy/>
        <sys_scope display_value="NowRoom">699b40c09340761005087efdfaba109b</sys_scope>
        <sys_update_name>sys_ux_data_broker_transform_5713066393a8329005087efdfaba10b2</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-10-18 20:05:18</sys_updated_on>
    </sys_ux_data_broker_transform>
    <sys_translated_text action="delete_multiple" query="documentkey=5713066393a8329005087efdfaba10b2"/>
</record_update>
